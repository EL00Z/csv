<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSV Data Cleaner - Smart Filtering Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .main-content {
            padding: 40px;
        }

        .upload-section {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 40px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
        }

        .file-input {
            display: none;
        }

        .file-input-label {
            display: inline-block;
            padding: 15px 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .file-info {
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            display: none;
        }

        .file-info.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .filter-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .filter-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        .filter-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }

        .filter-card h3 {
            margin-bottom: 20px;
            color: #667eea;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
        }

        .toggle-switch input {
            display: none;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: 0.4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: #667eea;
        }

        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }

        .keywords-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            max-height: 200px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .keyword-tag {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            margin: 3px;
            font-size: 0.9em;
            animation: popIn 0.3s ease;
        }

        @keyframes popIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .exclusion-tag {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .custom-keywords-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .custom-keywords-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .column-selector {
            margin: 30px 0;
            padding: 25px;
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-radius: 15px;
        }

        .column-selector h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .column-select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .column-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .action-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-process {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-process:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .btn-download {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(86, 171, 47, 0.4);
        }

        .btn-download:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(86, 171, 47, 0.6);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .stats-section {
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 15px;
            display: none;
        }

        .stats-section.active {
            display: block;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
        }

        .preview-section {
            margin-top: 30px;
            display: none;
        }

        .preview-section.active {
            display: block;
        }

        .preview-table {
            width: 100%;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }

        .preview-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .preview-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .preview-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        .preview-table tr:hover {
            background: #f8f9fa;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            .filter-section {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .main-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 CSV Data Cleaner</h1>
            <p>Smart filtering tool for cleaning and organizing your CSV data</p>
        </div>

        <div class="main-content">
            <div class="upload-section">
                <div class="file-input-wrapper">
                    <input type="file" id="csvFile" class="file-input" accept=".csv">
                    <label for="csvFile" class="file-input-label">
                        📁 Choose CSV File (Max 50MB)
                    </label>
                </div>
                <div id="fileInfo" class="file-info">
                    <strong>File:</strong> <span id="fileName"></span><br>
                    <strong>Size:</strong> <span id="fileSize"></span><br>
                    <strong>Rows:</strong> <span id="rowCount"></span><br>
                    <strong>Columns:</strong> <span id="columnCount"></span>
                </div>
            </div>

            <div class="column-selector" id="columnSelector" style="display: none;">
                <h3>🎯 Select Column to Filter</h3>
                <select id="columnSelect" class="column-select">
                    <option value="">Select a column...</option>
                </select>
            </div>

            <div class="filter-section">
                <div class="filter-card">
                    <h3>
                        ✅ Inclusion Keywords
                        <label class="toggle-switch">
                            <input type="checkbox" id="inclusionToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </h3>
                    <div class="keywords-container" id="inclusionKeywords"></div>
                    <textarea 
                        id="customInclusion" 
                        class="custom-keywords-input" 
                        placeholder="Add custom keywords separated by commas..."
                        rows="3"
                    ></textarea>
                </div>

                <div class="filter-card">
                    <h3>
                        ❌ Exclusion Keywords
                        <label class="toggle-switch">
                            <input type="checkbox" id="exclusionToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </h3>
                    <div class="keywords-container" id="exclusionKeywords"></div>
                    <textarea 
                        id="customExclusion" 
                        class="custom-keywords-input" 
                        placeholder="Add custom keywords separated by commas..."
                        rows="3"
                    ></textarea>
                </div>
            </div>

            <div class="action-buttons">
                <button id="processBtn" class="btn btn-process" disabled>
                    🚀 Process & Filter
                </button>
                <button id="downloadBtn" class="btn btn-download" style="display: none;">
                    ⬇️ Download Cleaned CSV
                </button>
            </div>

            <div id="statsSection" class="stats-section">
                <h3>📊 Processing Results</h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="originalRows">0</div>
                        <div class="stat-label">Original Rows</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="filteredRows">0</div>
                        <div class="stat-label">Filtered Rows</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="removedRows">0</div>
                        <div class="stat-label">Removed Rows</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="percentageKept">0%</div>
                        <div class="stat-label">Data Retained</div>
                    </div>
                </div>
            </div>

            <div id="previewSection" class="preview-section">
                <h3>👁️ Preview (First 10 rows of cleaned data)</h3>
                <div class="preview-table">
                    <table id="previewTable"></table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Default Keywords
        const defaultInclusionKeywords = [
            'architect', 'asset management', 'blockchain', 'capital markets', 'cbdc', 'ceo', 'chief', 
            'chief digital officer', 'chief innovation officer', 'chief strategy officer', 'cio', 'ciso', 
            'co-founder', 'coo', 'cpo', 'crypto', 'cto', 'custody', 'data intelligence', 'defi', 
            'developer', 'digital asset', 'digital banking', 'digital currency', 'digital transformation lead', 
            'director', 'director of digital assets', 'director of engineering', 'engineer', 'executive', 
            'fintech', 'founder', 'general manager', 'global head of digital assets', 'growth lead', 'head', 
            'head of blockchain and digital assets', 'head of defi', 'head of digital', 'head of digital assets', 
            'head of ecosystem', 'head of engineering', 'head of enterprise architecture', 'head of global payments', 
            'head of growth', 'head of innovation', 'head of it', 'head of payments', 'head of product', 
            'head of product innovation', 'head of retail payments', 'head of rwa', 'head of stablecoins', 
            'head of strategy', 'head of strategy and innovation', 'head of tokenization', 'innovation', 
            'lead', 'llm', 'manager', 'managing', 'managing director', 'managing partner', 'mena', 
            'open banking', 'partner', 'payment', 'payments', 'platform', 'president', 'principal', 
            'product', 'product head', 'product strategy', 'rwa', 'senior', 'specialist', 'stablecoin', 
            'strategy', 'tokenization', 'transformation', 'vp', 'vp of engineering', 'vp of it', 'vp of product'
        ];

        const defaultExclusionKeywords = [
            'account executive', 'accountant', 'academic', 'actor', 'administrative assistant', 'agriculture', 
            'airdrop', 'ambassador', 'angel', 'angel investor', 'analyst', 'artist', 'assistant', 'attorney', 
            'audit', 'auditor', 'back-end developer', 'bdr', 'business analyst', 'business development', 
            'business development representative', 'channel', 'chief of staff', 'community', 'community manager', 
            'construction', 'content', 'content creator', 'controller', 'cpa', 'customer', 'customer service representative', 
            'cyber security', 'data entry', 'data scientist', 'degen', 'devops engineer', 'doctor', 'editor', 
            'educator', 'energy', 'entertainment', 'entry-level', 'epamsystems', 'event manager', 'executive assistant', 
            'factory', 'farmer', 'film', 'finance manager', 'financial models', 'former', 'freight', 
            'front-end developer', 'gamer', 'gas', 'general counsel', 'giveaway', 'graphic designer', 
            'hardware', 'hardware engineer', 'hospitality', 'hr', 'hr manager', 'human resources', 'industrial', 
            'influencer', 'intern', 'inventory', 'investor relations', 'junior', 'journalist', 'kol', 'lawyer', 
            'lecturer', 'legal', 'legal counsel', 'logistics', 'manufacturing', 'marketer', 'marketing', 
            'marketing manager', 'marketing specialist', 'materials', 'mechanical engineer', 'media', 'memes', 
            'memecoin', 'mining', 'moderator', 'music', 'musician', 'non-profit', 'nurse', 'office manager', 
            'oil', 'operations manager', 'paralegal', 'petroleum', 'physical', 'physician', 'plant manager', 
            'podcast', 'pr', 'prediction', 'private banker', 'producer', 'professor', 'program', 
            'project management', 'promoter', 'procurement', 'public relations', 'qa', 'quality assurance', 
            'real estate', 'recruiter', 'recruitment consultant', 'researcher', 'risk', 'sales', 
            'sales consultant', 'sales representative', 'scientist', 'shill', 'shiller', 'shipping', 
            'singer', 'smm', 'social media', 'social media manager', 'software engineer', 'software test engineer', 
            'streamer', 'supply chain', 'support agent', 'sustainability', 'tax', 'teacher', 'team head', 
            'technical lead', 'technician', 'telecom', 'talent acquisition', 'trenches', 'transportation', 
            'user', 'ux researcher', 'venture partner', 'warehouse', 'web developer', 'writer', 'yapper', 'copywriter'
        ];

        let csvData = [];
        let headers = [];
        let processedData = [];

        // Initialize keywords display
        function displayKeywords() {
            const inclusionContainer = document.getElementById('inclusionKeywords');
            const exclusionContainer = document.getElementById('exclusionKeywords');
            
            inclusionContainer.innerHTML = defaultInclusionKeywords.map(k => 
                `<span class="keyword-tag">${k}</span>`
            ).join('');
            
            exclusionContainer.innerHTML = defaultExclusionKeywords.map(k => 
                `<span class="keyword-tag exclusion-tag">${k}</span>`
            ).join('');
        }

        // Parse CSV
        function parseCSV(text) {
            const lines = text.split('\n').filter(line => line.trim());
            const result = [];
            const headers = [];
            
            // Parse headers
            const headerLine = lines[0];
            let inQuotes = false;
            let currentField = '';
            
            for (let i = 0; i < headerLine.length; i++) {
                const char = headerLine[i];
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    headers.push(currentField.trim());
                    currentField = '';
                } else {
                    currentField += char;
                }
            }
            headers.push(currentField.trim());
            
            // Parse data rows
            for (let i = 1; i < lines.length; i++) {
                const row = {};
                const line = lines[i];
                let currentField = '';
                let fieldIndex = 0;
                let inQuotes = false;
                
                for (let j = 0; j < line.length; j++) {
                    const char = line[j];
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === ',' && !inQuotes) {
                        row[headers[fieldIndex]] = currentField.trim();
                        currentField = '';
                        fieldIndex++;
                    } else {
                        currentField += char;
                    }
                }
                row[headers[fieldIndex]] = currentField.trim();
                result.push(row);
            }
            
            return { headers, data: result };
        }

        // Convert data back to CSV
        function dataToCSV(headers, data) {
            const csvRows = [];
            csvRows.push(headers.join(','));
            
            for (const row of data) {
                const values = headers.map(header => {
                    const value = row[header] || '';
                    // Escape quotes and wrap in quotes if contains comma
                    if (value.includes(',') || value.includes('"') || value.includes('\n')) {
                        return `"${value.replace(/"/g, '""')}"`;
                    }
                    return value;
                });
                csvRows.push(values.join(','));
            }
            
            return csvRows.join('\n');
        }

        // Get all keywords (default + custom)
        function getAllKeywords(type) {
            const defaults = type === 'inclusion' ? defaultInclusionKeywords : defaultExclusionKeywords;
            const customInput = document.getElementById(type === 'inclusion' ? 'customInclusion' : 'customExclusion');
            const customKeywords = customInput.value
                .split(',')
                .map(k => k.trim().toLowerCase())
                .filter(k => k);
            
            return [...defaults, ...customKeywords];
        }

        // Check if text matches any keyword
        function matchesKeywords(text, keywords) {
            if (!text) return false;
            const lowerText = text.toLowerCase();
            return keywords.some(keyword => lowerText.includes(keyword));
        }

        // Filter data
        function filterData() {
            const selectedColumn = document.getElementById('columnSelect').value;
            if (!selectedColumn) {
                alert('Please select a column to filter');
                return;
            }
            
            const inclusionEnabled = document.getElementById('inclusionToggle').checked;
            const exclusionEnabled = document.getElementById('exclusionToggle').checked;
            
            const inclusionKeywords = inclusionEnabled ? getAllKeywords('inclusion') : [];
            const exclusionKeywords = exclusionEnabled ? getAllKeywords('exclusion') : [];
            
            processedData = csvData.filter(row => {
                const cellValue = row[selectedColumn];
                
                // If exclusion is enabled and matches, exclude the row
                if (exclusionEnabled && matchesKeywords(cellValue, exclusionKeywords)) {
                    return false;
                }
                
                // If inclusion is enabled, only include if matches
                if (inclusionEnabled && inclusionKeywords.length > 0) {
                    return matchesKeywords(cellValue, inclusionKeywords);
                }
                
                // If only exclusion is enabled or no filters, include the row
                return true;
            });
            
            updateStats();
            showPreview();
        }

        // Update statistics
        function updateStats() {
            const originalCount = csvData.length;
            const filteredCount = processedData.length;
            const removedCount = originalCount - filteredCount;
            const percentage = originalCount > 0 ? Math.round((filteredCount / originalCount) * 100) : 0;
            
            document.getElementById('originalRows').textContent = originalCount;
            document.getElementById('filteredRows').textContent = filteredCount;
            document.getElementById('removedRows').textContent = removedCount;
            document.getElementById('percentageKept').textContent = percentage + '%';
            
            document.getElementById('statsSection').classList.add('active');
        }

        // Show preview
        function showPreview() {
            const table = document.getElementById('previewTable');
            table.innerHTML = '';
            
            if (processedData.length === 0) {
                table.innerHTML = '<tr><td style="text-align: center; padding: 20px;">No data matches the filter criteria</td></tr>';
                return;
            }
            
            // Create header row
            const headerRow = document.createElement('tr');
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            table.appendChild(headerRow);
            
            // Add data rows (max 10)
            const previewData = processedData.slice(0, 10);
            previewData.forEach(row => {
                const tr = document.createElement('tr');
                headers.forEach(header => {
                    const td = document.createElement('td');
                    td.textContent = row[header] || '';
                    tr.appendChild(td);
                });
                table.appendChild(tr);
            });
            
            document.getElementById('previewSection').classList.add('active');
        }

        // File upload handler
        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            // Check file size (50MB limit)
            if (file.size > 50 * 1024 * 1024) {
                alert('File size exceeds 50MB limit');
                e.target.value = '';
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(event) {
                const text = event.target.result;
                const parsed = parseCSV(text);
                
                csvData = parsed.data;
                headers = parsed.headers;
                
                // Update file info
                document.getElementById('fileName').textContent = file.name;
                document.getElementById('fileSize').textContent = (file.size / 1024).toFixed(2) + ' KB';
                document.getElementById('rowCount').textContent = csvData.length;
                document.getElementById('columnCount').textContent = headers.length;
                document.getElementById('fileInfo').classList.add('active');
                
                // Populate column selector
                const columnSelect = document.getElementById('columnSelect');
                columnSelect.innerHTML = '<option value="">Select a column...</option>';
                headers.forEach(header => {
                    const option = document.createElement('option');
                    option.value = header;
                    option.textContent = header;
                    if (header.toLowerCase().includes('job') || header.toLowerCase().includes('title')) {
                        option.selected = true;
                    }
                    columnSelect.appendChild(option);
                });
                
                document.getElementById('columnSelector').style.display = 'block';
                document.getElementById('processBtn').disabled = false;
                
                // Reset previous results
                document.getElementById('statsSection').classList.remove('active');
                document.getElementById('previewSection').classList.remove('active');
                document.getElementById('downloadBtn').style.display = 'none';
            };
            
            reader.readAsText(file);
        });

        // Process button handler
        document.getElementById('processBtn').addEventListener('click', function() {
            filterData();
            document.getElementById('downloadBtn').style.display = 'inline-block';
        });

        // Download button handler
        document.getElementById('downloadBtn').addEventListener('click', function() {
            const csv = dataToCSV(headers, processedData);
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'cleaned_data.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        });

        // Initialize
        displayKeywords();
    </script>
</body>
</html>
